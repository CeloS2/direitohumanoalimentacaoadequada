<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Direito Humano à Alimentação Adequada</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        :root {
            --primary-color: #2c3e50;
            --secondary-color: #e74c3c;
            --accent-color: #27ae60;
            --text-color: #333;
            --light-bg: #f9f9f9;
            --dark-bg: #222;
        }

        /* Barra de rolagem personalizada */
        ::-webkit-scrollbar {
            width: 12px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #000;
            border-radius: 6px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #333;
        }

        body {
            background-color: var(--light-bg);
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
        }

        header {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1543352634-a1c51d9f1fa7?ixlib=rb-4.0.3&ixid=MnwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8&auto=format&fit=crop&w=1170&q=80') center/cover no-repeat;
            color: white;
            text-align: center;
            padding: 6rem 2rem;
            position: relative;
        }

        .header-content {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }

        .subtitle {
            font-size: 1.5rem;
            margin-bottom: 2rem;
        }

        .btn {
            display: inline-block;
            background: var(--secondary-color);
            color: white;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .btn:hover {
            background: #c0392b;
            transform: translateY(-3px);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        section {
            margin: 4rem 0;
            padding: 2rem;
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: var(--primary-color);
            margin-bottom: 2rem;
            text-align: center;
            font-size: 2.5rem;
            position: relative;
            padding-bottom: 0.5rem;
        }

        h2:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--secondary-color);
        }

        p {
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
        }

        .problem-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .problem-card {
            background: var(--light-bg);
            border-radius: 8px;
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .problem-card:hover {
            transform: translateY(-5px);
        }

        .problem-img {
            height: 200px;
            overflow: hidden;
            position: relative;
        }

        .problem-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .problem-card:hover .problem-img img {
            transform: scale(1.1);
        }

        .caption-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
        }

        .caption-text {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 1rem;
            font-size: 0.9rem;
            display: none;
        }

        .problem-content {
            padding: 1.5rem;
        }

        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: var(--primary-color);
            color: white;
            padding: 1.5rem;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .solution-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            align-items: center;
        }

        @media (max-width: 768px) {
            .solution-content {
                grid-template-columns: 1fr;
            }
        }

        .solution-img {
            border-radius: 10px;
            overflow: hidden;
        }

        .solution-img img {
            width: 100%;
            height: auto;
            display: block;
        }

        .call-to-action {
            text-align: center;
            background: linear-gradient(to right, var(--primary-color), var(--accent-color));
            color: white;
            padding: 4rem 2rem;
        }

        .comments-section {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .comment-form {
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .comment-list {
            margin-top: 2rem;
        }

        .comment {
            background: var(--light-bg);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            position: relative;
        }

        .comment-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 0.5rem;
        }

        .comment-author {
            font-weight: bold;
            color: var(--primary-color);
        }

        .comment-date {
            color: #777;
            font-size: 0.9rem;
        }

        footer {
            background: var(--dark-bg);
            color: white;
            text-align: center;
            padding: 2rem;
            margin-top: 4rem;
        }

        .accessibility-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary-color);
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }

        .solutions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-top: 2rem;
        }

        .solution-card {
            background: var(--light-bg);
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }

        .solution-card:hover {
            transform: translateY(-5px);
        }

        .solution-card i {
            font-size: 2.5rem;
            color: var(--accent-color);
            margin-bottom: 1rem;
        }

        .awareness-section {
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            color: white;
            padding: 4rem 2rem;
            text-align: center;
            border-radius: 10px;
        }

        .awareness-content {
            max-width: 800px;
            margin: 0 auto;
        }

        .action-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .action-step {
            background: rgba(255, 255, 255, 0.1);
            padding: 1.5rem;
            border-radius: 8px;
            backdrop-filter: blur(10px);
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Direito Humano à Alimentação Adequada</h1>
            <p class="subtitle">Conscientização, dados e soluções para um problema global</p>
            <a href="#problem" class="btn">Saiba Mais</a>
        </div>
    </header>

    <div class="container">
        <section id="problem">
            <h2>Comer é um ato de dignidade, não um privilégio</h2>
            <p>O Direito Humano à Alimentação Adequada (DHAA) é um direito humano básico reconhecido internacionalmente, que garante a todas as pessoas o acesso regular e permanente a alimentos de qualidade, em quantidade suficiente, com base em práticas alimentares saudáveis.</p>
            <p>No entanto, milhões de pessoas em todo o mundo ainda sofrem com a fome e a má nutrição, enquanto outras enfrentam problemas de saúde relacionados à alimentação inadequada.</p>

            <div class="problem-grid">
                <div class="problem-card">
                    <div class="problem-img">
                        <img src="https://observatorio3setor.org.br/wp-content/uploads/2017/09/Ree.png" alt="Desperdício de alimentos">
                        <button class="caption-btn" aria-label="Mostrar legenda">ℹ️</button>
                        <div class="caption-text">
                            Cerca de 1/3 de todos os alimentos produzidos no mundo são desperdiçados anualmente, enquanto milhões passam fome.
                        </div>
                    </div>
                    <div class="problem-content">
                        <h3>Desperdício de Alimentos</h3>
                        <p>Enquanto milhões passam fome, um terço de toda a comida produzida no mundo é desperdiçada anualmente.</p>
                    </div>
                </div>

                <div class="problem-card">
                    <div class="problem-img">
                        <img src="https://thenationonlineng.net/wp-content/uploads/2020/03/malnourished-children.jpg">
                        <button class="caption-btn" aria-label="Mostrar legenda">ℹ️</button>
                        <div class="caption-text">
                            A má nutrição infantil afeta o desenvolvimento físico e cognitivo, perpetuando ciclos de pobreza.
                        </div>
                    </div>
                    <div class="problem-content">
                        <h3>Má Nutrição Infantil</h3>
                        <p>149 milhões de crianças menores de 5 anos sofrem de desnutrição crônica, afetando seu desenvolvimento.</p>
                    </div>
                </div>

                <div class="problem-card">
                    <div class="problem-img">
                        <img src="https://th.bing.com/th/id/R.30c4ac4cc28df73002e1b39194c5cced?rik=a1IxAQuk2Mv9eA&riu=http%3a%2f%2fi0.statig.com.br%2fbancodeimagens%2f30%2f8b%2fyq%2f308byqmbr5rufxz9g2p5ol0z4.jpg&ehk=9LoQP9iuKL2LK%2bBqaCGPRi1%2bQNOiKbcnSdMuU1A0Yz0%3d&risl=&pid=ImgRaw&r=0">
                        <button class="caption-btn" aria-label="Mostrar legenda">ℹ️</button>
                        <div class="caption-text">
                            Comunidades vulneráveis frequentemente têm acesso limitado a alimentos nutritivos e a preços acessíveis.
                        </div>
                    </div>
                    <div class="problem-content">
                        <h3>Acesso Desigual</h3>
                        <p>Comunidades vulneráveis têm acesso limitado a alimentos nutritivos, perpetuando ciclos de pobreza.</p>
                    </div>
                </div>
            </div>
        </section>

        <section id="data">
            <h2>Dados Alarmantes</h2>
            <p>Os números relacionados à fome e à má nutrição no mundo são alarmantes e mostram a urgência de ações concretas para garantir o direito humano à alimentação adequada para todos.</p>

            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-number">828 milhões</div>
                    <p>de pessoas passam fome no mundo</p>
                </div>
                <div class="stat-card">
                    <div class="stat-number">45%</div>
                    <p>das mortes infantis estão relacionadas à desnutrição</p>
                </div>
                <div class="stat-card">
                    <div class="stat-number">3,1 bilhões</div>
                    <p>de pessoas não podem ter uma dieta saudável</p>
                </div>
                <div class="stat-card">
                    <div class="stat-number">130 milhões</div>
                    <p>de pessoas foram levadas à fome pela COVID-19 e conflitos</p>
                </div>
            </div>

            <p>Fonte: FAO (Organização das Nações Unidas para Alimentação e Agricultura) - 2022</p>
        </section>

        <section id="solutions">
            <h2>Soluções Propostas</h2>
            
            <div class="solutions-grid">
                <div class="solution-card">
                    <i class="fas fa-ban"></i>
                    <h3>Combate ao Desperdício</h3>
                    <p>Implementar políticas públicas e iniciativas privadas para reduzir o desperdício de alimentos em toda a cadeia produtiva, desde a colheita até o consumo.</p>
                    <ul>
                        <li>Campanhas de conscientização sobre aproveitamento integral dos alimentos</li>
                        <li>Incentivos fiscais para doação de excedentes alimentares</li>
                        <li>Tecnologias para melhorar a conservação e armazenamento</li>
                    </ul>
                </div>
                
                <div class="solution-card">
                    <i class="fas fa-seedling"></i>
                    <h3>Agricultura Sustentável</h3>
                    <p>Incentivar práticas agrícolas sustentáveis que respeitem o meio ambiente e garantam alimentos saudáveis para as gerações presentes e futuras.</p>
                    <ul>
                        <li>Transição para agricultura agroecológica e orgânica</li>
                        <li>Suporte técnico e financeiro para pequenos agricultores</li>
                        <li>Proteção e recuperação de solos e recursos hídricos</li>
                    </ul>
                </div>
                
                <div class="solution-card">
                    <i class="fas fa-book-reader"></i>
                    <h3>Educação Alimentar</h3>
                    <p>Promover programas de educação alimentar e nutricional para capacitar as pessoas a fazerem escolhas alimentares saudáveis.</p>
                    <ul>
                        <li>Inserção de educação alimentar no currículo escolar</li>
                        <li>Oficinas culinárias com aproveitamento integral de alimentos</li>
                        <li>Campanhas públicas sobre alimentação saudável</li>
                    </ul>
                </div>
                
                <div class="solution-card">
                    <i class="fas fa-landmark"></i>
                    <h3>Políticas Públicas</h3>
                    <p>Fortalecer políticas públicas que garantam o acesso à alimentação adequada, especialmente para populações vulneráveis.</p>
                    <ul>
                        <li>Programas de alimentação escolar com produtos locais</li>
                        <li>Restrições à publicidade de alimentos ultraprocessados</li>
                        <li>Regulamentação da composição nutricional dos alimentos</li>
                    </ul>
                </div>
                
                <div class="solution-card">
                    <i class="fas fa-hand-holding-usd"></i>
                    <h3>Apoio à Agricultura Familiar</h3>
                    <p>Fortalecer a agricultura familiar que produz a maior parte dos alimentos consumidos no Brasil.</p>
                    <ul>
                        <li>Crédito rural acessível para pequenos produtores</li>
                        <li>Programas de compra governamental da agricultura familiar</li>
                        <li>Assistência técnica rural gratuita</li>
                    </ul>
                </div>
                
                <div class="solution-card">
                    <i class="fas fa-store"></i>
                    <h3>Circuitos Curtos de Comercialização</h3>
                    <p>Estimular a conexão direta entre produtores rurais e consumidores.</p>
                    <ul>
                        <li>Feiras livres e feiras orgânicas em bairros</li>
                        <li>Programas de CSA (Comunidade que Sustenta a Agricultura)</li>
                        <li>Compras coletivas organizadas por comunidades</li>
                    </ul>
                </div>
            </div>
        </section>

        <section class="awareness-section">
            <div class="awareness-content">
                <h2>Conscientização e Ação</h2>
                <p>O direito à alimentação adequada é fundamental para a dignidade humana. Cada um de nós pode contribuir para mudar essa realidade:</p>
                
                <div class="action-steps">
                    <div class="action-step">
                        <h3>Como Cidadão</h3>
                        <ul>
                            <li>Reduza o desperdício de alimentos em sua casa</li>
                            <li>Apoie agricultores locais e produtos da estação</li>
                            <li>Participe de iniciativas de doação e voluntariado</li>
                            <li>Eduque-se e eduque outros sobre nutrição adequada</li>
                        </ul>
                    </div>
                    
                    <div class="action-step">
                        <h3>Como Consumidor</h3>
                        <ul>
                            <li>Prefira alimentos in natura e minimamente processados</li>
                            <li>Leia rótulos e evite produtos com excesso de aditivos</li>
                            <li>Participe de feiras locais e compre diretamente do produtor</li>
                            <li>Reduza o consumo de alimentos ultraprocessados</li>
                        </ul>
                    </div>
                    
                    <div class="action-step">
                        <h3>Como Agente de Mudança</h3>
                        <ul>
                            <li>Cobre dos governantes políticas públicas efetivas</li>
                            <li>Engaje-se em movimentos pela segurança alimentar</li>
                            <li>Divulgue informações qualificadas sobre o tema</li>
                            <li>Participe de conselhos de alimentação escolar</li>
                        </ul>
                    </div>
                </div>
                
                <p style="margin-top: 2rem;">Juntos podemos construir um mundo onde ninguém passe fome!</p>
                <a href="#comments" class="btn" style="margin-top: 1.5rem;">Deixe seu Comentário</a>
            </div>
        </section>

        <section class="comments-section" id="comments">
            <h2>Comentários</h2>
            <p>Deixe sua opinião, sugestão ou compartilhe experiências relacionadas ao direito à alimentação adequada.</p>
            
            <div class="comment-form">
                <div class="form-group">
                    <label for="name">Nome:</label>
                    <input type="text" id="name" placeholder="Seu nome">
                </div>
                <div class="form-group">
                    <label for="comment">Comentário:</label>
                    <textarea id="comment" placeholder="Seu comentário"></textarea>
                </div>
                <button class="btn" id="submit-comment">Enviar Comentário</button>
            </div>

            <div class="comment-list" id="comment-list">
                <div class="comment">
                    <div class="comment-header">
                        <span class="comment-author">Maria Silva</span>
                        <span class="comment-date">10/09/2025</span>
                    </div>
                    <p>É fundamental discutirmos esse tema. Em minha comunidade, temos um projeto de horta comunitária que tem ajudado muitas famílias.</p>
                </div>
                
                <div class="comment">
                    <div class="comment-header">
                        <span class="comment-author">João Santos</span>
                        <span class="comment-date">05/09/2025</span>
                    </div>
                    <p>Precisamos de mais políticas públicas voltadas para a segurança alimentar nas periferias. Ótima iniciativa este site!</p>
                </div>
                
                <div class="comment">
                    <div class="comment-header">
                        <span class="comment-author">Ana Costa</span>
                        <span class="comment-date">01/09/2025</span>
                    </div>
                    <p>Gostaria de saber como posso me envolver mais ativamente nesta causa. Vocês poderiam indicar organizações que trabalham com isso?</p>
                </div>
            </div>
        </section>
    </div>

    <div class="accessibility-btn" aria-label="Opções de acessibilidade">
        <i class="fas fa-universal-access"></i>
    </div>

    <footer>
        <p>© 2023 - Direito Humano à Alimentação Adequada | Conscientização e Ação</p>
        <p>Site criado para fins educativos e de conscientização</p>
        <p>Fontes: FAO, ONU, IBGE e Organização Mundial da Saúde</p>
    </footer>

    <script>
        // Script para as legendas de acessibilidade
        document.querySelectorAll('.caption-btn').forEach(button => {
            button.addEventListener('click', function() {
                const caption = this.nextElementSibling;
                caption.style.display = caption.style.display === 'block' ? 'none' : 'block';
            });
        });

        // Script para enviar comentários
        document.getElementById('submit-comment').addEventListener('click', function() {
            const nameInput = document.getElementById('name');
            const commentInput = document.getElementById('comment');
            
            if (nameInput.value.trim() === '' || commentInput.value.trim() === '') {
                alert('Por favor, preencha todos os campos!');
                return;
            }
            
            const commentList = document.getElementById('comment-list');
            const newComment = document.createElement('div');
            newComment.className = 'comment';
            
            const date = new Date();
            const formattedDate = `${date.getDate()}/${date.getMonth() + 1}/${date.getFullYear()}`;
            
            newComment.innerHTML = `
                <div class="comment-header">
                    <span class="comment-author">${nameInput.value}</span>
                    <span class="comment-date">${formattedDate}</span>
                </div>
                <p>${commentInput.value}</p>
            `;
            
            commentList.prepend(newComment);
            
            // Limpar os campos
            nameInput.value = '';
            commentInput.value = '';
            
            alert('Comentário enviado com sucesso!');
        });

        // Acessibilidade - aumento de fonte
        const accessibilityBtn = document.querySelector('.accessibility-btn');
        let fontSizeIncreased = false;
        
        accessibilityBtn.addEventListener('click', function() {
            const elements = document.querySelectorAll('body, p, h1, h2, h3, a, button');
            elements.forEach(el => {
                if (fontSizeIncreased) {
                    el.style.fontSize = '';
                } else {
                    const currentSize = window.getComputedStyle(el).fontSize;
                    const newSize = parseFloat(currentSize) * 1.2;
                    el.style.fontSize = `${newSize}px`;
                }
            });
            
            fontSizeIncreased = !fontSizeIncreased;
        });
    </script>

   <!-- === Início: Painel Leitura PT-BR (Glassmorphism preto) === -->
<style>
  /* Painel moderno - glassmorphism (fundo preto translúcido) */
  #tts-panel {
    position: fixed;
    right: 20px;
    bottom: 90px;
    width: 360px;
    background: rgba(10,10,12,0.45);
    backdrop-filter: blur(14px) saturate(120%);
    -webkit-backdrop-filter: blur(14px) saturate(120%);
    border-radius: 18px;
    box-shadow: 0 12px 30px rgba(0,0,0,0.45), inset 0 1px 0 rgba(255,255,255,0.02);
    padding: 16px;
    font-family: "Inter", "Segoe UI", Roboto, sans-serif;
    z-index: 4000;
    display: none;
    color: #e6e6e6;
    transform-origin: bottom right;
  }
  #tts-panel.show { animation: popIn 320ms cubic-bezier(.2,.9,.3,1); display:block; }
  @keyframes popIn {
    from { transform: translateY(12px) scale(.98); opacity:0 }
    to { transform: translateY(0) scale(1); opacity:1 }
  }

  #tts-panel h4 {
    margin: 0 0 8px 0;
    font-size: 15px;
    text-align: center;
    color: #fdfdfd;
    letter-spacing: .2px;
  }

  label.small { display:block; font-size:12px; color:#ffffff; margin-top:8px; }
  select, input[type="range"] {
    width:100%; margin-top:6px; padding:8px 10px; border-radius:8px; border: none;
    background: rgba(0, 0, 0, 0.522); color:#fff; font-size:13px;
    -webkit-appearance:none;
  }

  .controls-row { display:flex; gap:8px; margin-top:12px; }
  .controls-row button {
    flex:1; padding:10px; border-radius:10px; border: none; font-weight:700; cursor:pointer;
    transition: transform .12s ease, filter .12s ease;
  }
  .btn-play { background: linear-gradient(90deg,#2ecc71,#27ae60); color:#06100b; }
  .btn-select { background: linear-gradient(90deg,#3498db,#2c82c9); color:#fff; }
  .btn-pause { background: linear-gradient(90deg,#f1c40f,#f39c12); color:#101010; }
  .btn-stop { background: linear-gradient(90deg,#ff6b6b,#e74c3c); color:#fff; }
  .controls-row button:hover { transform: translateY(-3px); filter:brightness(1.04); }

  .theme-row { display:flex; gap:8px; align-items:center; margin-top:12px; }
  .theme-row button {
    padding:8px 10px; border-radius:10px; border:none; cursor:pointer; background: linear-gradient(90deg,#8e44ad,#6c2cad); color:#fff; font-weight:700;
  }
  .note { font-size:12px; color:#c7c9cd; margin-top:10px; text-align:center; }

  /* destaque que acompanha a fala */
  .tts-current {
    background: linear-gradient(90deg, rgba(255,230,128,0.95), rgba(255,205,80,0.95));
    color:#111 !important;
    border-radius:4px;
    padding:0 1px;
  }

  /* responsividade */
  @media (max-width:420px){
    #tts-panel { width: 92%; left: 4%; right:auto; bottom: 20px; }
  }
</style>

<div id="tts-panel" aria-hidden="true" role="dialog" aria-label="Painel de leitura em Português">
  <h4>🔊 Leitura em Português (PT-BR)</h4>

  <label class="small" for="voiceSelect">Voz (apenas PT-BR)</label>
  <select id="voiceSelect" aria-label="Selecionar voz em Português"></select>

  <label class="small" for="rateRange">Velocidade: <span id="rateNum">1</span>x</label>
  <input id="rateRange" type="range" min="0.6" max="1.8" step="0.05" value="1">

  <label class="small" for="pitchRange">Tom: <span id="pitchNum">1</span></label>
  <input id="pitchRange" type="range" min="0.6" max="1.6" step="0.05" value="1">

  <div style="margin-top:8px;">
    <input id="highlightToggle" type="checkbox" checked>
    <label for="highlightToggle" style="color:#cfd2d6; font-size:13px; margin-left:6px;">Destacar texto em leitura</label>
  </div>

  <div class="controls-row" style="margin-top:10px;">
    <button id="btnReadPage" class="btn-play" title="Ler a página inteira">Ler Página</button>
    <button id="btnReadSelection" class="btn-select" title="Ler o trecho selecionado" disabled>Ler Seleção</button>
  </div>

  <div class="controls-row">
    <button id="btnPause" class="btn-pause" title="Pausar / Retomar">Pausar</button>
    <button id="btnStop" class="btn-stop" title="Parar leitura">Parar</button>
  </div>

  <div class="theme-row">
    <button id="btnTheme">▶ Tema</button>
    <input id="themeVol" type="range" min="0" max="1" step="0.01" value="0.25" aria-label="Volume do tema">
  </div>

  <div class="note">Atalhos: <strong>Alt+L</strong> (ler), <strong>Alt+P</strong> (pausar), <strong>Alt+S</strong> (parar)</div>
</div>

<audio id="siteTheme" loop preload="none"
  src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_7e1f8d6b5f.mp3?filename=calm-acoustic-guitar-111094.mp3"></audio>

<script>
(function(){
  // Elementos
  const panel = document.getElementById('tts-panel');
  const accessibilityBtn = document.querySelector('.accessibility-btn');
  const voiceSelect = document.getElementById('voiceSelect');
  const rateRange = document.getElementById('rateRange');
  const pitchRange = document.getElementById('pitchRange');
  const rateNum = document.getElementById('rateNum');
  const pitchNum = document.getElementById('pitchNum');
  const highlightToggle = document.getElementById('highlightToggle');
  const btnReadPage = document.getElementById('btnReadPage');
  const btnReadSelection = document.getElementById('btnReadSelection');
  const btnPause = document.getElementById('btnPause');
  const btnStop = document.getElementById('btnStop');
  const btnTheme = document.getElementById('btnTheme');
  const themeVol = document.getElementById('themeVol');
  const siteTheme = document.getElementById('siteTheme');

  const synth = window.speechSynthesis;
  let voices = [];
  let currentUtterance = null;
  let mapping = []; // array de {node, start, end}

  // Atualiza sliders visuais
  rateRange.addEventListener('input', ()=> rateNum.textContent = rateRange.value);
  pitchRange.addEventListener('input', ()=> pitchNum.textContent = pitchRange.value);

  // --- VOICES: somente PT-BR --- //
  function populatePTBRVoices(){
    voices = synth.getVoices() || [];
    voiceSelect.innerHTML = '';
    // filtrar por lang que contenha 'pt' (pt, pt-BR)
    const ptVoices = voices.filter(v => (v.lang || '').toLowerCase().includes('pt'));
    if(ptVoices.length === 0){
      const opt = document.createElement('option');
      opt.value = '';
      opt.textContent = 'Nenhuma voz PT-BR disponível no navegador';
      voiceSelect.appendChild(opt);
      // mostra uma dica visível
      const warn = document.createElement('div');
      warn.style.fontSize='12px'; warn.style.color='#ffccbc'; warn.style.marginTop='8px';
      warn.textContent = 'Seu navegador / sistema não possui voz PT-BR nativa. Para voz natural, integre TTS externo (ex: Google/Azure/OpenAI).';
      if(!panel.querySelector('.voice-warning')) { warn.className='voice-warning'; panel.appendChild(warn); }
      return;
    }
    // preencher select somente com pt voices
    ptVoices.sort((a,b)=> (a.name||'').localeCompare(b.name||''));
    ptVoices.forEach(v=>{
      const opt = document.createElement('option');
      opt.value = v.name || v.voiceURI;
      opt.textContent = `${v.name} — ${v.lang}`;
      voiceSelect.appendChild(opt);
    });
    // tentar selecionar pt-BR preferencial
    const prefer = ptVoices.find(v => /pt[-_]?br/i.test(v.lang)) || ptVoices[0];
    if(prefer) voiceSelect.value = prefer.name || prefer.voiceURI;
    // remove aviso se existir
    const old = panel.querySelector('.voice-warning'); if(old) old.remove();
  }

  populatePTBRVoices();
  if('onvoiceschanged' in speechSynthesis) speechSynthesis.onvoiceschanged = populatePTBRVoices;

  // --- Construir índice textual do container (nodes e offsets) --- //
  function buildTextIndex(container){
    mapping = [];
    let walker = document.createTreeWalker(container, NodeFilter.SHOW_TEXT, null, false);
    let node;
    let pos = 0;
    while((node = walker.nextNode())){
      const text = node.nodeValue || '';
      if(text.trim().length === 0){ pos += text.length; continue; }
      mapping.push({ node: node, start: pos, end: pos + text.length });
      pos += text.length;
    }
  }

  // Procura trecho a partir do charIndex e envolve com span .tts-current
  let lastHighlight = null;
  function highlightAt(charIndex, charLength){
    clearHighlight();
    if(!highlightToggle.checked) return;
    if(!mapping.length) buildTextIndex(document.querySelector('main') || document.body);
    // ajuste de segurança
    charLength = (charLength && charLength > 0) ? charLength : 6;
    // encontrar node
    const m = mapping.find(seg => charIndex >= seg.start && charIndex < seg.end);
    if(!m) return;
    const localStart = charIndex - m.start;
    const localEnd = Math.min(localStart + charLength, m.end - m.start);
    try {
      const range = document.createRange();
      range.setStart(m.node, localStart);
      range.setEnd(m.node, localEnd);
      const span = document.createElement('span');
      span.className = 'tts-current';
      range.surroundContents(span);
      lastHighlight = span;
      // rolar para o elemento atual (mobile friendly)
      span.scrollIntoView({behavior:'smooth', block:'center', inline:'nearest'});
    } catch(e){
      // se não for possível (HTML complexo), tenta abordagem fallback substituindo texto completo (evita quebra)
    }
  }
  function clearHighlight(){
    if(lastHighlight){
      // substitui o elemento pelo seu texto
      const txt = document.createTextNode(lastHighlight.textContent);
      lastHighlight.parentNode.replaceChild(txt, lastHighlight);
      lastHighlight = null;
      // rebuild mapping because DOM changed
      mapping = [];
    }
  }

  // --- Função que executa a fala e anexa as fontes no final --- //
  function speakText(rawText){
    if(!rawText || rawText.trim().length === 0) { alert('Nenhum texto encontrado para ler.'); return; }
    // acrescenta a frase de fontes (garantir separação)
    const suffix = "\n\nFontes: FAO, ONU, IBGE e Organização Mundial da Saúde.";
    const text = rawText.trim() + suffix;
    if(!('speechSynthesis' in window)) { alert('TTS não suportado neste navegador.'); return; }
    // rebuild mapping for highlight positions
    buildTextIndex(document.querySelector('main') || document.body);
    // cancelar fala anterior
    speechSynthesis.cancel();
    const utt = new SpeechSynthesisUtterance(text);
    // definir lingua PT-BR explicitamente
    utt.lang = 'pt-BR';
    // selecionar voz PT-BR (se disponível)
    const selName = voiceSelect.value;
    if(selName){
      const v = (speechSynthesis.getVoices() || []).find(x => (x.name === selName) || (x.voiceURI === selName));
      if(v) utt.voice = v;
    }
    utt.rate = parseFloat(rateRange.value) || 1;
    utt.pitch = parseFloat(pitchRange.value) || 1;

    // boundary -> highlight
    utt.onboundary = function(e){
      // e.charIndex indica posição dentro do texto
      if(!e || typeof e.charIndex === 'undefined') return;
      const ci = e.charIndex;
      const clen = e.charLength || 8;
      highlightAt(ci, clen);
    };
    utt.onend = function(){ clearHighlight(); currentUtterance = null; btnPause.textContent = 'Pausar'; };
    utt.onerror = function(){ clearHighlight(); currentUtterance = null; btnPause.textContent = 'Pausar'; };

    speechSynthesis.speak(utt);
    currentUtterance = utt;
    btnPause.textContent = 'Pausar';
  }

  // --- Botões --- //
  btnReadPage.addEventListener('click', ()=>{
    // preferir main > .container > body
    const main = document.querySelector('main') || document.querySelector('.container') || document.body;
    const txt = main.innerText || main.textContent;
    speakText(txt);
  });

  btnReadSelection.addEventListener('click', ()=>{
    const sel = window.getSelection();
    const txt = sel ? sel.toString() : '';
    if(!txt || txt.trim() === '') { alert('Selecione o trecho que deseja ouvir.'); return; }
    speakText(txt);
  });

  btnPause.addEventListener('click', ()=>{
    if(!('speechSynthesis' in window)) return;
    if(speechSynthesis.speaking && !speechSynthesis.paused){ speechSynthesis.pause(); btnPause.textContent='Continuar'; }
    else if(speechSynthesis.paused){ speechSynthesis.resume(); btnPause.textContent='Pausar'; }
  });

  btnStop.addEventListener('click', ()=>{
    if(!('speechSynthesis' in window)) return;
    speechSynthesis.cancel(); clearHighlight(); currentUtterance = null; btnPause.textContent = 'Pausar';
  });

  // habilitar/desabilitar botão de ler seleção
  document.addEventListener('selectionchange', ()=>{
    const s = window.getSelection();
    btnReadSelection.disabled = !(s && s.toString().trim());
  });

  // Tema musical
  btnTheme.addEventListener('click', ()=>{
    if(siteTheme.paused){ siteTheme.volume = parseFloat(themeVol.value||0.25); siteTheme.play().catch(()=>{ alert('Navegador bloqueou reprodução automática do tema. Interaja com a página e tente novamente.'); }); btnTheme.textContent='⏸ Tema'; }
    else { siteTheme.pause(); btnTheme.textContent='▶ Tema'; }
  });
  themeVol.addEventListener('input', ()=> siteTheme.volume = parseFloat(themeVol.value));

  // atalhos
  document.addEventListener('keydown', (e)=>{
    if(!e.altKey) return;
    const k = e.key.toLowerCase();
    if(k === 'l') btnReadPage.click();
    if(k === 'p') btnPause.click();
    if(k === 's') btnStop.click();
  });

  // Toggle painel com o botão .accessibility-btn (clique único)
  if(accessibilityBtn){
    accessibilityBtn.addEventListener('click', ()=>{
      const isVisible = panel.classList.contains('show');
      if(isVisible){
        panel.classList.remove('show');
        panel.setAttribute('aria-hidden','true');
      } else {
        panel.classList.add('show');
        panel.setAttribute('aria-hidden','false');
      }
    });
    // permitir abrir com Enter/Space quando está focado
    accessibilityBtn.addEventListener('keydown', (ev)=> {
      if(ev.key === 'Enter' || ev.key === ' ') { ev.preventDefault(); accessibilityBtn.click(); }
    });
  } else {
    // Se não houver o botão, opcional: se quiser exibir durante desenvolvimento, descomente:
    // panel.classList.add('show'); panel.setAttribute('aria-hidden','false');
    console.warn('.accessibility-btn não encontrado — verifique se o botão existe com essa classe.');
  }

  // Feedback se não existir voz PT-BR
  setTimeout(()=>{
    const hasPT = Array.from(speechSynthesis.getVoices() || []).some(v => (v.lang||'').toLowerCase().includes('pt'));
    if(!hasPT){
      // adiciona aviso breve no painel caso o usuário abra
      const warn = document.createElement('div');
      warn.style.fontSize='12px'; warn.style.color='#ffd9c7'; warn.style.marginTop='8px';
      warn.textContent = 'Aviso: não foi encontrada voz PT-BR nativa no navegador/dispositivo.';
      if(!panel.querySelector('.pt-warning')) { warn.className='pt-warning'; panel.appendChild(warn); }
    }
  }, 800);

  // Mobile NOTE: em alguns iOS/Android, onboundary pode não fornecer charIndex preciso.
  // O código tenta mapear e destacar; se não funcionar perfeitamente em algum navegador, considerar integração a TTS em nuvem para controle preciso.

})();
</script>
<!-- === Fim: Painel Leitura PT-BR === -->
</body>
</html>
